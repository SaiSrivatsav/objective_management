//@ui5-bundle mboobjectives/Component-preload.js
sap.ui.predefine("mboobjectives/Component", ["sap/ui/core/UIComponent","mboobjectives/model/models"],(e,t)=>{"use strict";return e.extend("mboobjectives.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init(){e.prototype.init.apply(this,arguments);this.setModel(t.createDeviceModel(),"device");this.getRouter().initialize()}})});
sap.ui.predefine("mboobjectives/controller/App.controller", ["sap/ui/core/mvc/Controller"],e=>{"use strict";return e.extend("mboobjectives.controller.App",{onInit(){}})});
sap.ui.predefine("mboobjectives/controller/Main.controller", ["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/ui/core/BusyIndicator","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/m/MessageBox"],(e,t,o,i,s,n)=>{"use strict";return e.extend("mboobjectives.controller.Main",{onInit(){var e=this.getOwnerComponent().getRouter();e.getRoute("RouteMain").attachPatternMatched(this._onObjectMatched,this)},async _onObjectMatched(){this._i18nModel=this.getOwnerComponent().getModel("i18n").getResourceBundle();this.getOwnerComponent().getModel("MboDetails").setData([]);this.getOwnerComponent().getModel("Participants").setData([]);o.show();await this.getParticipants();o.hide()},async getParticipants(){const e=this.getView().getModel("Participants");e.setData([]);e.setSizeLimit(1e3);const t=this.getOwnerComponent().getManifestObject().resolveUri(this.getOwnerComponent().getManifestEntry("sap.app").dataSources.commissionsService.uri);var i=[];let s=0;const r=100;let a=true;try{while(a){const e=await fetch(`${t}/participants?skip=${s}&top=${r}`,{method:"GET",contentType:"application/json",dataType:"json"});if(!e.ok){throw new Error("Network response was not ok")}const o=await e.json();const n=Array.isArray(o.participants)?o.participants:o.value||[];if(n.length>0){i.push(...n)}if(n.length<r){a=false}else{s+=r}}e.setData(i.flat())}catch(e){o.hide();n.error("Error fetching participants:",e);console.error("Error fetching participants:",e)}},async onTerritoryChange(e){const t=this.getView().getModel("Participants");const o=e.getSource().getSelectedKey();const i=t.getData().filter(e=>e.userId===o);this.getView().byId("idParticipantName").setText(i.length>0?i[0].firstName+" "+i[0].lastName:"");this.getView().byId("idTargetComp").setText(i.length>0?i[0]?.salary?.value+" "+i[0]?.salary?.unitType?.name:"");const s=await this.getPosition(i[0].payeeSeq);if(s){this.getView().byId("idPosition").setText(s)}await this.getMboDetails(o)},async getMboDetails(e){const t=this.getOwnerComponent().getManifestObject().resolveUri(this.getOwnerComponent().getManifestEntry("sap.app").dataSources.mainService.uri);try{o.show();const i=await fetch(`${t}/MboDetails?$filter=territoryId eq '${e}'`,{method:"GET",contentType:"application/json",dataType:"json"});if(!i.ok){throw new Error("Network response was not ok")}const s=await i.json();const n=Array.isArray(s.mbos)?s.mbos:s.value||[];const r=this.getView().getModel("MboDetails");r.setData(n);o.hide()}catch(e){o.hide();n.error("Error fetching MBO details:",e);console.error("Error fetching MBO details:",e)}},onSaveObjectives(e){const i=this.getView().getModel("MboDetails");const s=i.getData();const r=[];for(let e=0;e<s.length;e++){const t=s[e];r.push({territoryId:this.getView().byId("idTerritoryId").getSelectedKey(),position:this.getView().byId("idPosition").getText(),participantName:this.getView().byId("idParticipantName").getText(),objectiveId:t.objectiveId||null,objective:t.objective,mboWeightage:t.mboWeightage,comments:t.comments,mboScore:t.mboScore})}const a=this.getOwnerComponent().getManifestObject().resolveUri(this.getOwnerComponent().getManifestEntry("sap.app").dataSources.mainService.uri);o.show();fetch(`${a}/saveMBOObjectives`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mboData:r})}).then(e=>{o.hide();if(!e.ok){throw new Error("Network response was not ok")}return e.json()}).then(e=>{t.show("MBO Objectives saved successfully")}).catch(e=>{o.hide();n.error("Error saving MBO details:",e);console.error("Error saving MBO details:",e)})},async getPosition(e){const t=this.getOwnerComponent().getManifestObject().resolveUri(this.getOwnerComponent().getManifestEntry("sap.app").dataSources.commissionsService.uri);try{const o=await fetch(`${t}/positions?$filter=payee eq '${e}'`,{method:"GET",contentType:"application/json",dataType:"json"});if(!o.ok){throw new Error("Network response was not ok")}const i=await o.json();const s=Array.isArray(i.positions)?i.positions:i.value||[];return s[s.length-1].description}catch(e){o.hide();n.error("Error fetching position:",e);console.error("Error fetching position:",e)}},onAddObjective(e){const t=this.getView().getModel("MboDetails");let o=t.getData();if(!Array.isArray(o)){o=[]}const i={objective:"",mboWeightage:"",comments:"",mboScore:""};o.push(i);t.setData(o);if(typeof t.refresh==="function"){t.refresh(true)}},onDeleteObjective(e){o.show();const t=Number(e.getParameter("listItem").getBindingContext("MboDetails").sPath.split("/")[1]);const i=this.getView().getModel("MboDetails");let s=i.getData();s.splice(t,1);i.setData(s);if(typeof i.refresh==="function"){i.refresh(true);o.hide()}}})});
sap.ui.predefine("mboobjectives/model/models", ["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
sap.ui.require.preload({
	"mboobjectives/i18n/i18n.properties":'# This is the resource bundle for mboobjectives\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Objective Management\n\n#YDES: Application description\nappDescription=An SAP Fiori application.\n#XTIT: Main view title\ntitle=Objective Management\n\n#XFLD,60\nmboobjectives-manage.flpTitle=Objective Management\n',
	"mboobjectives/manifest.json":'{"_version":"1.76.0","sap.app":{"id":"mboobjectives","type":"application","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":[""]},"applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.19.1","toolsId":"a6cdfbc4-0074-4915-9296-cfb1eec4a6aa"},"dataSources":{"mainService":{"uri":"/odata/v4/mbo-objectives/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}},"commissionsService":{"uri":"commissions/api/v2","type":"OData","settings":{"odataVersion":"2.0"}}},"crossNavigation":{"inbounds":{"mboobjectives-manage":{"semanticObject":"mboobjectives","action":"manage","title":"Objective Management","icon":"sap-icon://end-user-experience-monitoring","signature":{"parameters":{},"additionalParameters":"allowed"}}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":false,"dependencies":{"minUI5Version":"1.141.1","libs":{"sap.m":{},"sap.ui.core":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"mboobjectives.i18n.i18n","supportedLocales":[""]}},"":{"dataSource":"mainService","preload":true,"settings":{"operationMode":"Server","autoExpandSelect":true,"earlyRequests":true}},"Participants":{"type":"sap.ui.model.json.JSONModel","preload":true,"settings":{"defaultBindingMode":"TwoWay"}},"MboDetails":{"type":"sap.ui.model.json.JSONModel","preload":true,"settings":{"defaultBindingMode":"TwoWay"}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","controlAggregation":"pages","controlId":"app","transition":"slide","type":"View","viewType":"XML","path":"mboobjectives.view","async":true,"viewPath":"mboobjectives.view"},"routes":[{"name":"RouteMain","pattern":":?query:","target":["TargetMain"]}],"targets":{"TargetMain":{"id":"Main","name":"Main"}}},"rootView":{"viewName":"mboobjectives.view.App","type":"XML","id":"App","async":true}},"sap.cloud":{"public":true,"service":"mboobjectives"}}',
	"mboobjectives/view/App.view.xml":'<mvc:View controllerName="mboobjectives.controller.App"\n    displayBlock="true"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><App id="app"></App></mvc:View>',
	"mboobjectives/view/Main.view.xml":'<mvc:View xmlns:core="sap.ui.core" xmlns:form="sap.ui.layout.form" xmlns:uxap="sap.uxap" controllerName="mboobjectives.controller.Main"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><uxap:ObjectPageLayout id="idObjectPage" showFooter="true"><uxap:headerTitle ><uxap:ObjectPageHeader \n                    objectTitle="MBO Scoring" \n                    objectSubtitle="Update Employee\'s MBO Scores"\n                    objectImageShape="Circle"\n                    isObjectIconAlwaysVisible="true"\n                    isObjectSubtitleAlwaysVisible="true"\n                    isActionAreaAlwaysVisible="true"\n                    isObjectTitleAlwaysVisible="true"\n                    objectImageBackgroundColor="Accent6"\n                    objectImageURI="sap-icon://end-user-experience-monitoring"><uxap:actions></uxap:actions></uxap:ObjectPageHeader></uxap:headerTitle><uxap:sections><uxap:ObjectPageSection title="Employee Information" titleUppercase="false"><uxap:subSections><uxap:ObjectPageSubSection ><VBox ><form:SimpleForm id="idEmployeeForm" editable="true" layout="ColumnLayout"><form:content><Label id="idLab-TerritoryId" text="Territory Id"></Label><ComboBox id="idTerritoryId" items="{ path: \'Participants>/\' }" selectionChange="onTerritoryChange" showSecondaryValues="true"><core:ListItem key="{Participants>userId}" text="{Participants>userId}" additionalText="{Participants>firstName} {Participants>lastName}" /></ComboBox><Label id="idLab-Position" text="Position"></Label><Text id="idPosition"></Text><Label id="idLab-ParticipantName" text="Participant Name"></Label><Text id="idParticipantName" ></Text><Label id="idLab-TargetComp" text="Target Compensation"></Label><Text id="idTargetComp"></Text></form:content></form:SimpleForm></VBox></uxap:ObjectPageSubSection></uxap:subSections></uxap:ObjectPageSection><uxap:ObjectPageSection title="MBO Details" titleUppercase="false"><uxap:subSections><uxap:ObjectPageSubSection ><VBox ><Table id="idMBODetailTab" mode="Delete" delete="onDeleteObjective" inset="false" width="auto" items="{MboDetails>/}"><headerToolbar><OverflowToolbar ><Title text="Objectives"></Title><ToolbarSpacer /><Button id="idAddBtn" icon="sap-icon://add" press="onAddObjective"></Button><Button id="idSave" text="Save" icon="sap-icon://save" type="Ghost" press="onSaveObjectives"></Button></OverflowToolbar></headerToolbar><columns><Column ><Label text="MBO Objective"></Label></Column><Column ><Label text="MBO Weightage"></Label></Column><Column ><Label text="Comments"></Label></Column><Column ><Label text="MBO Score"></Label></Column></columns><noData><IllustratedMessage \n                                            title="No data"\n                                            visible="true" \n                                            description="Enter a valid territory id to see MBO Details" \n                                            illustrationType="sapIllus-NoActivities"></IllustratedMessage></noData><ColumnListItem><Input value="{MboDetails>objective}" change="onObjectiveChange"></Input><Input value="{MboDetails>mboWeightage}" change="onWeightageChange"></Input><Input value="{MboDetails>comments}" change="onCommentsChange"></Input><Input value="{MboDetails>mboScore}" change="onScoreChange"></Input></ColumnListItem></Table></VBox></uxap:ObjectPageSubSection></uxap:subSections></uxap:ObjectPageSection><uxap:ObjectPageSection title="Notifications" titleUppercase="false"><uxap:subSections><uxap:ObjectPageSubSection ><VBox ><IllustratedMessage \n                                    illustrationType="sapIllus-NoActivities"\n                                    title="No data"\n                                    visible="true"\n                                    description="Enter a valid territory id to see the notifications summary"></IllustratedMessage></VBox></uxap:ObjectPageSubSection></uxap:subSections></uxap:ObjectPageSection></uxap:sections><uxap:footer><OverflowToolbar ><ToolbarSpacer ></ToolbarSpacer><Button id="idSubmit" text="Submit" type="Emphasized"></Button><Button id="idCancel" text="Cancel" type="Ghost"></Button></OverflowToolbar></uxap:footer></uxap:ObjectPageLayout></mvc:View>'
});
//# sourceMappingURL=Component-preload.js.map
